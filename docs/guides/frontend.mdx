---
title: Frontend Integration
description: Connect a React / Next.js app to the Verbitto program.
---

## Wallet Setup

Verbitto uses `@solana/wallet-adapter-react` for wallet connectivity. Wrap your app with the required providers.

```tsx
import { WalletAdapterNetwork } from '@solana/wallet-adapter-base';
import {
  ConnectionProvider,
  WalletProvider,
} from '@solana/wallet-adapter-react';
import { WalletModalProvider } from '@solana/wallet-adapter-react-ui';
import { clusterApiUrl } from '@solana/web3.js';
import { useMemo } from 'react';

export function SolanaProviders({ children }: { children: React.ReactNode }) {
  const network = WalletAdapterNetwork.Devnet;
  const endpoint = useMemo(() => clusterApiUrl(network), [network]);

  return (
    <ConnectionProvider endpoint={endpoint}>
      <WalletProvider wallets={[]} autoConnect>
        <WalletModalProvider>{children}</WalletModalProvider>
      </WalletProvider>
    </ConnectionProvider>
  );
}
```

<Callout type="info">
Passing an empty `wallets` array enables Wallet Standard auto-detection (Phantom, Solflare, etc.).
</Callout>

## Anchor Provider

Create an Anchor `Program` instance from the connected wallet and the IDL.

```typescript
import { useConnection, useWallet } from '@solana/wallet-adapter-react';
import { AnchorProvider, Program } from '@coral-xyz/anchor';
import { useMemo } from 'react';

import idl from '../idl/task_escrow.json';
import type { TaskEscrow } from '../idl/task_escrow';

const PROGRAM_ID = '4r3ciYyag1GhBjep45mTs7nGa92kpYfRj3pqFnDqckP5';

export function useProgram() {
  const { connection } = useConnection();
  const wallet = useWallet();

  return useMemo(() => {
    if (!wallet.publicKey) return null;
    const provider = new AnchorProvider(connection, wallet as any, {
      commitment: 'confirmed',
    });
    return new Program<TaskEscrow>(idl as any, PROGRAM_ID, provider);
  }, [connection, wallet]);
}
```

## Deriving PDAs

All Verbitto accounts are Program Derived Addresses. Use deterministic seeds to locate them.

```typescript
import { PublicKey } from '@solana/web3.js';
import BN from 'bn.js';

const PROGRAM_ID = new PublicKey(
  '4r3ciYyag1GhBjep45mTs7nGa92kpYfRj3pqFnDqckP5'
);

export function findPlatformPDA() {
  return PublicKey.findProgramAddressSync(
    [Buffer.from('platform')],
    PROGRAM_ID
  );
}

export function findTaskPDA(creator: PublicKey, taskIndex: BN) {
  return PublicKey.findProgramAddressSync(
    [
      Buffer.from('task'),
      creator.toBuffer(),
      taskIndex.toArrayLike(Buffer, 'le', 8),
    ],
    PROGRAM_ID
  );
}

export function findEscrowPDA(taskPDA: PublicKey) {
  return PublicKey.findProgramAddressSync(
    [Buffer.from('escrow'), taskPDA.toBuffer()],
    PROGRAM_ID
  );
}

export function findAgentPDA(wallet: PublicKey) {
  return PublicKey.findProgramAddressSync(
    [Buffer.from('agent'), wallet.toBuffer()],
    PROGRAM_ID
  );
}
```

## Reading Accounts

Fetch and deserialise on-chain accounts using Anchor's built-in deserialisers.

```typescript
const [taskPDA] = findTaskPDA(creatorPubkey, new BN(0));
const task = await program.account.task.fetch(taskPDA);
console.log('Status:', task.status);
console.log('Bounty:', task.bountyAmount.toString());
```

Fetch all tasks with optional filters:

```typescript
const allTasks = await program.account.task.all();

// Filter by creator
const myTasks = await program.account.task.all([
  { memcmp: { offset: 8, bytes: wallet.publicKey.toBase58() } },
]);
```

## Sending Transactions

```typescript
const tx = await program.methods
  .createTask(
    descriptionHash,
    new BN(bountyLamports),
    new BN(deadline),
    category,
    requiredSkills
  )
  .accounts({
    creator: wallet.publicKey,
    task: taskPDA,
    escrow: escrowPDA,
    platform: platformPDA,
    systemProgram: SystemProgram.programId,
  })
  .rpc();

// Wait for confirmation
const latestBlockhash = await connection.getLatestBlockhash();
await connection.confirmTransaction({
  signature: tx,
  ...latestBlockhash,
});
```

## Event Listening

Subscribe to Anchor events for real-time updates.

```typescript
const listener = program.addEventListener('TaskCreated', (event) => {
  console.log('New task:', event.task.toString());
  console.log('Creator:', event.creator.toString());
});

// Clean up on unmount
return () => program.removeEventListener(listener);
```

<Callout type="warning">
Always remove event listeners in your component cleanup to prevent memory leaks and duplicate subscriptions.
</Callout>
